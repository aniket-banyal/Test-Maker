{% extends 'quiz/new_update_quiz_common.html' %}
{% load static %}

{% block content %}
<div class="container">

    <form action='{% url "quiz-update" quiz.id %}' method='post' class="quiz-form">
        {% csrf_token %}

        {% include 'quiz/settings_modal.html' %}

        <div class="heading">
            <input type='text' class="heading__text" name='quiz' required autofocus value={{quiz.name}}>
        </div>

        {% for question in quiz.question_set.all %}

        <div class="question">
            <label for="q_{{forloop.counter}}">{{forloop.counter}}.</label>
            <input type="text" name="q_{{forloop.counter}}" id="q_{{forloop.counter}}" class="quiz-form__question"
                required value='{{question.question}}'>

            {% for choice in question.choice_set.all %}

            <div class="quiz-form__ans">
                {% if question.type == 'mcq' %}
                <input type="radio" required name='{{forloop.parentloop.counter}}_radio_option'
                    value='{{forloop.counter}}' 
                    {% if question.mcqanswer.answer == forloop.counter %} checked {% endif %}>
                <span class="design"></span>

                {% elif question.type == 'checkbox' %}
                <input type="checkbox" name='{{forloop.parentloop.counter}}_checkbox_{{forloop.counter}}' 
                {% for answer in question.checkboxanswer_set.all %}
                {% if answer.answer == forloop.parentloop.counter%} checked {% endif %}
                {% endfor %}>

                {% endif %}

                <input type="text" required name="{{forloop.parentloop.counter}}_option{{forloop.counter}}"
                    value='{{choice.choice}}'>
                <svg fill="#5c626f" class="delete_choice
                {% if question.type == 'mcq' %}
                delete_mcq_choice
                {% elif question.type == 'checkbox' %}
                delete_checkbox_choice
                {% endif %}
                "
                 xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24">
                    <path
                        d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z">
                    </path>
                    <path d="M0 0h24v24H0z" fill="none"></path>
                </svg>
            </div>

            {% endfor %}

            {% if question.type == 'mcq' %}

            <div class="quiz-form__ans">
                <input type="radio">
                <span class="design"></span>
                <input type="text" class='add_mcq_choice' placeholder="Add Option">
            </div>

            {% elif question.type == 'checkbox' %}

            <div class="quiz-form__ans">
                <input type="checkbox">
                <input type="text" class='add_checkbox_choice' placeholder="Add Option">
            </div>

            {% endif %}

            <div class="footer">
                <div class="point">
                    <input type="number" name="{{forloop.counter}}_point" value='{{question.point}}' min=0 required>
                    <span>points</span>
                </div>
                <div class='footerBtns'>
                    <button type="button" class="duplicateBtn
                    {% if question.type == 'mcq' %}
                    mcqDuplicateBtn
                    {% elif question.type == 'checkbox' %}
                    checkboxDuplicateBtn
                    {% endif %}
                    ">Duplicate</button>
                    <button type="button" class='deleteBtn'>Delete</button>
                </div>
            </div>
        </div>

        {% endfor %}
        <button type='submit' id='submit' hidden></button>
    </form>
</div>

{% endblock content %}